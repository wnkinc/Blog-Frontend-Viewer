<!-- File: views/partials/comments.ejs -->
<section class="comments-section">
    <!-- Comments Header with Subscribe Button -->
    <div class="comments-header">
      <h2>Comments</h2>
      <button class="subscribe-button">Subscribe</button>
    </div>

    <!-- Comment Submission Form -->
    <div class="comment-form-container">
        <img
          src="<%= post.author.profilePicUrl || '/default-profile.png' %>"
          alt="<%= post.author.username %>'s profile picture"
          class="profile-pic"
        />
      <form
        class="comment-form"
        action="/post/<%= post.slug %>/comments"
        method="POST"
      >
        <textarea
          name="comment"
          rows="2"
          placeholder="Write your comment here..."
          required
        ></textarea>
        <button type="submit">Submit Comment</button>
      </form>
    </div>

    <!-- Display Comments -->
    <div class="comments-container">
        <% if (comments.length > 0) { %>
          <ul>
            <% comments.forEach(comment => { %>
              <li>
                <p><strong><%= comment.user.username %></strong>: <%= comment.content %></p>
                
                <% if (comment.replies.length > 0) { %>
                  <ul>
                    <% comment.replies.forEach(reply => { %>
                      <li>
                        <p><strong><%= reply.user.username %></strong>: <%= reply.content %></p>
                      </li>
                    <% }) %>
                  </ul>
                <% } %>
      
              </li>
            <% }) %>
          </ul>
        <% } else { %>
          <p>No comments yet.</p>
        <% } %>
      </div>
      
  </section>
</section>
