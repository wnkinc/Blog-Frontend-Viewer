<!-- File: views/partials/comments.ejs -->
<section class="comments-section">
    <!-- Comments Header with Subscribe Button -->
    <div class="comments-header">
      <h2>Comments</h2>
      <button class="subscribe-button">Subscribe</button>
    </div>

    <!-- Comment Submission Form -->
    <div class="comment-form-container">
        <img
          src="<%= post.author.profilePicUrl || '/default-profile.png' %>"
          alt="<%= post.author.username %>'s profile picture"
          class="profile-pic"
        />
      <form
        class="comment-form"
        action="/posts/<%= post.id %>/comments"
        method="POST"
      >
        <textarea
          name="comment"
          rows="2"
          placeholder="Write your comment here..."
          required
        ></textarea>
        <button type="submit">Submit Comment</button>
      </form>
    </div>

    <!-- Display Comments -->
    <div class="comments-container">
      <% if (comments && comments.length > 0) { %>
      <ul class="comments-list">
        <% comments.forEach(function(comment) { %>
        <li class="comment">
          <div class="comment-header">
            <!-- Adjust the author property as needed -->
            <span class="comment-author"
              ><%= comment.author.username || comment.author.name %></span
            >
            <!-- Format the date; ensure `createdAt` exists on your comment -->
            <span class="comment-date"
              ><%= new Date(comment.createdAt).toLocaleString() %></span
            >
          </div>
          <div class="comment-body">
            <p><%= comment.body %></p>
          </div>
        </li>
        <% }); %>
      </ul>
      <% } else { %>
      <p class="no-comments">No comments yet. Be the first to comment!</p>
      <% } %>
    </div>
  </section>
</section>
